--Vinculamos as contas ao nregobrig 23 e 24
begin;
CREATE TABLE IF NOT EXISTS "public".w_regobrig_ref
(
  conta TEXT
, nregobrig INTEGER
, atributosf TEXT
, natureza TEXT
);
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('351120200',24,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('351120900',24,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710100',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710501',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710502',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710503',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710504',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710505',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710506',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710507',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710508',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710509',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710510',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710511',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710512',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710513',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710514',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710515',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710516',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710517',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710518',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710519',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710520',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710521',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710522',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710523',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710524',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710525',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710526',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710527',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710528',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361710600',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720100',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720501',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720502',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720503',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720504',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720505',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720506',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720507',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720508',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720509',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720510',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720511',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720512',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720513',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720514',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720515',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720516',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720517',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720518',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720519',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720520',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720521',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720522',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720523',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720524',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720525',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720526',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720527',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720528',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361720600',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730100',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730501',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730502',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730503',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730504',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730505',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730506',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730507',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730508',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730509',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730510',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730511',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730512',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730513',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730514',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730515',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730516',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730517',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730518',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730519',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730520',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730521',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730522',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730523',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730524',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730525',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730526',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730527',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730528',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361730600',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740100',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740501',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740502',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740503',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740504',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740505',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740506',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740507',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740508',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740509',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740510',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740511',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740512',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740513',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740514',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740515',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740516',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740517',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740518',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740519',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740520',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740521',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740522',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740523',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740524',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740525',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740526',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740527',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740528',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361740600',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750100',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750501',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750502',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750503',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750504',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750505',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750506',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750507',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750508',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750509',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750510',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750511',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750512',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750513',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750514',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750515',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750516',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750517',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750518',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750519',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750520',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750521',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750522',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750523',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750524',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750525',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750526',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750527',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750528',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('361750600',23,null,'D');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('451120200',24,null,'C');
INSERT INTO "public".w_regobrig_ref(conta, nregobrig, atributosf, natureza) VALUES ('451120900',24,null,'C');

update conplano set c60_nregobrig = 23 where exists (select 1 from w_regobrig_ref where conta = substr(c60_estrut,1,9) and nregobrig = 23) and c60_anousu = 2016;
update conplano set c60_nregobrig = 24 where exists (select 1 from w_regobrig_ref where conta = substr(c60_estrut,1,9) and nregobrig = 24) and c60_anousu = 2016;

commit;
--Vinculamos os estruturais com nregobrig 23 e 24 ao contacorrente 3
begin;
create temp table w_nroregobrig_contacorrente on commit drop as select 1 as nroregobrig, 2 as contacorrente limit 1;
delete from w_nroregobrig_contacorrente;
insert into w_nroregobrig_contacorrente values (23,3),(24,3);

insert into conplanocontacorrente
SELECT distinct
nextval('conplanocontacorrente_c18_sequencial_seq') c18_sequencial,
c60_codcon,
c61_anousu,
contacorrente
FROM conplanoreduz
INNER JOIN conplano ON conplano.c60_codcon = conplanoreduz.c61_codcon
AND conplano.c60_anousu = conplanoreduz.c61_anousu
INNER JOIN w_nroregobrig_contacorrente ON c60_nregobrig = nroregobrig
LEFT JOIN conplanocontacorrente ON conplanocontacorrente.c18_codcon = conplano.c60_codcon
AND conplanocontacorrente.c18_anousu = conplano.c60_anousu
WHERE c60_nregobrig in (23,24)
  AND c61_instit = 1
  AND c18_sequencial IS NULL;
commit;